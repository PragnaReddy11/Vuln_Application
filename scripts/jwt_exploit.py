import datetime
import jwt
from jwt.algorithms import get_default_algorithms
# import requests

if __name__ =="__main__":
    PUBLIC_KEY = "-----BEGIN PRIVATE KEY-----\nMC4CAQAwBQYDK2VwBCIEIEokVjz+sRKb52ZWuE4E6K5sAjDyZ/puX7Go0jlKfK7k\n-----END PRIVATE KEY-----\n"
    payload = {
        "role": "admin",
        "username": "admin",
        "exp": datetime.datetime.now(datetime.timezone.utc) + datetime.timedelta(minutes=15)
    }
    token = jwt.encode(payload, PUBLIC_KEY, algorithm="HS256")
    print(token)
    with open("/home/student/Vuln_Application/keys/public_key.pem", 'rb') as f:
        PUBLIC_KEY = f.read()
    decoded_token = jwt.decode(token, PUBLIC_KEY, algorithms=get_default_algorithms())
    print(decoded_token)


